
@page "{id:int}"
@model AuditSentinel.Pages.Vulnerabilidades.DetailsModel
@{
    ViewData["Title"] = "Detalles de la Vulnerabilidad";
}
<div class="p-5">
<h2>Detalles</h2>

<div class="card p-3">
    <dl class="row">
        <dt class="col-sm-3">Nombre</dt><dd class="col-sm-9">@Model.Vulnerabilidad.NombreVulnerabilidad</dd>
        <dt class="col-sm-3">Riesgo</dt><dd class="col-sm-9">@Model.Vulnerabilidad.NivelRiesgo</dd>
        <dt class="col-sm-3">Detectada</dt><dd class="col-sm-9">@Model.Vulnerabilidad.FechaDetectada</dd>
        <dt class="col-sm-3">Descripción</dt><dd class="col-sm-9">@Model.Vulnerabilidad.Descripcion</dd>
        <dt class="col-sm-3">Comando</dt><dd class="col-sm-9"><pre class="mb-0">@Model.Vulnerabilidad.Comando</pre></dd>
        <dt class="col-sm-3">Resultado esperado</dt><dd class="col-sm-9">@Model.Vulnerabilidad.ResultadoEsperado</dd>
    </dl>

    <hr />
    <div class="row">
        <div class="col-md-6">
            <h5>Escaneos asociados</h5>
            <ul>
                @foreach (var ev in Model.Vulnerabilidad.EscaneosVulnerabilidades ?? Enumerable.Empty<AuditSentinel.Models.EscaneosVulnerabilidades>())
                {
                    <li>@ev.Escaneos?.NombreEscaneo (@ev.Escaneos?.Estado)</li>
                }
            </ul>
        </div>
        <div class="col-md-6">
            <h5>Plantillas asociadas</h5>
            <ul>
                @foreach (var pv in Model.Vulnerabilidad.PlantillasVulnerabilidades ?? Enumerable.Empty<AuditSentinel.Models.PlantillasVulnerabilidades>())
                {
                    <li>@pv.Plantillas?.NombrePlantilla (@pv.Plantillas?.Version)</li>
                }
            </ul>
        </div>
    </div>

    <div class="mt-3 d-flex gap-2">
        <a asp-page="Edit" asp-route-id="@Model.Vulnerabilidad.IdVulnerabilidad" class="btn btn-warning">Editar</a>
        <a asp-page="Index" class="btn btn-secondary">Volver</a>
    </div>
    </div>
    </div>